import{j as e,a as f,u as h}from"./index-YmJ5rGxO.js";import{r as m}from"./vendor-redux-FsoCpCcR.js";import{C as g,a as x,b as v,c as b,d as y}from"./card-C1Os2Jzs.js";import{B as w}from"./button-BZ__ZVvs.js";import{I as c}from"./input-lKSy0GOu.js";import{L as r}from"./label-C0QsUGTD.js";import{T as I}from"./textarea-CojeXS5Z.js";import{S as k,a as S,b as H,c as P,d as u}from"./select-CkWAxkRE.js";import{T as L,a as J,b as A,c as E}from"./tabs-ikx3-Flg.js";import"./vendor-react-BGYP6dvN.js";import"./utils-Ckn0VQvi.js";import"./vendor-recharts-Bkxxru1U.js";function O(){const[i,o]=m.useState({businessName:"",ownerName:"",email:"",phone:"",whatsappNumber:"",address:"",location:"",workingHoursStart:"09:00",workingHoursEnd:"18:00",carHandlingCapacity:"SINGLE",maxConcurrentJobs:1}),[a,l]=m.useState({capacity:5,currency:"USD",timezone:"UTC",autoSendWhatsApp:!0,workingHours:{start:"09:00",end:"18:00"},notificationPreferences:{jobCreated:!0,jobCompleted:!0,jobDelivered:!0,planExpiry:!0}}),[p,j]=m.useState(!1),[T,C]=m.useState(!0),N=async()=>{try{const[s,d]=await Promise.allSettled([f.get("/admin/business"),f.get("/admin/settings")]);if(s.status==="fulfilled"&&s.value?.data?.success&&s.value.data.business){const n=s.value.data.business;o({businessName:n.businessName||"",ownerName:n.ownerName||"",email:n.email||"",phone:n.phone||"",whatsappNumber:n.whatsappNumber||"",address:n.address||"",location:n.location||"",workingHoursStart:n.workingHoursStart||"09:00",workingHoursEnd:n.workingHoursEnd||"18:00",carHandlingCapacity:n.carHandlingCapacity||"SINGLE",maxConcurrentJobs:n.maxConcurrentJobs??1})}if(d.status==="fulfilled"&&d.value?.data?.success&&d.value.data.settings){const n=d.value.data.settings;l(t=>({...t,capacity:n.capacity??t.capacity,currency:n.currency??t.currency,timezone:n.timezone??t.timezone,autoSendWhatsApp:n.autoSendWhatsApp!==void 0?n.autoSendWhatsApp:t.autoSendWhatsApp,workingHours:n.workingHours?{start:n.workingHours.start||"09:00",end:n.workingHours.end||"18:00"}:t.workingHours,notificationPreferences:n.notificationPreferences?{...t.notificationPreferences,...n.notificationPreferences}:t.notificationPreferences}))}d.status==="rejected"&&h.error("Failed to load settings")}catch{h.error("Failed to load page")}finally{C(!1)}};m.useEffect(()=>(C(!0),N().then(()=>{}),()=>{}),[]);const F=async()=>{j(!0);try{await f.put("/admin/business",i),h.success("Business information updated successfully"),N()}catch(s){h.error(s.response?.data?.message||"Failed to update business information")}finally{j(!1)}},W=async()=>{j(!0);try{const s={capacity:a.capacity,timezone:a.timezone,autoSendWhatsApp:a.autoSendWhatsApp,workingHours:a.workingHours||{start:"09:00",end:"18:00"},notificationPreferences:a.notificationPreferences},d=await f.put("/admin/settings",s);if(d.data.success){if(h.success("Settings saved successfully"),d.data.settings){const n=d.data.settings;l(t=>({...t,...n,workingHours:n.workingHours?{...t.workingHours,...n.workingHours}:t.workingHours,notificationPreferences:n.notificationPreferences?{...t.notificationPreferences,...n.notificationPreferences}:t.notificationPreferences}))}}else h.error("Failed to save settings")}catch(s){h.error(s.response?.data?.message||"Failed to save settings")}finally{j(!1)}};return T?e.jsx("div",{className:"space-y-4",children:[1,2,3].map(s=>e.jsx(g,{className:"animate-pulse",children:e.jsx(x,{className:"h-20 bg-muted rounded-lg"})},s))}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-semibold tracking-tight text-slate-800",children:"Settings"}),e.jsx("p",{className:"text-muted-foreground text-sm mt-0.5",children:"Manage your business information and preferences"})]}),e.jsxs(L,{defaultValue:"business",className:"space-y-4",children:[e.jsxs(J,{className:"flex flex-wrap gap-1",children:[e.jsx(A,{value:"business",children:"Business Information"}),e.jsx(A,{value:"settings",children:"Settings & Preferences"})]}),e.jsx(E,{value:"business",className:"space-y-4",children:e.jsxs(g,{children:[e.jsxs(x,{children:[e.jsx(v,{children:"Business Information"}),e.jsx(b,{children:"Update your business details. You can edit this information anytime."})]}),e.jsxs(y,{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(r,{htmlFor:"businessName",children:"Business Name *"}),e.jsx(c,{id:"businessName",value:i.businessName,onChange:s=>o({...i,businessName:s.target.value}),required:!0})]}),e.jsxs("div",{children:[e.jsx(r,{htmlFor:"ownerName",children:"Owner Name *"}),e.jsx(c,{id:"ownerName",value:i.ownerName,onChange:s=>o({...i,ownerName:s.target.value}),required:!0})]})]}),e.jsxs("div",{children:[e.jsx(r,{htmlFor:"email",children:"Business Email *"}),e.jsx(c,{id:"email",type:"email",value:i.email,onChange:s=>o({...i,email:s.target.value}),required:!0})]}),e.jsxs("div",{children:[e.jsx(r,{htmlFor:"address",children:"Address *"}),e.jsx(I,{id:"address",value:i.address,onChange:s=>o({...i,address:s.target.value}),rows:3,required:!0})]}),e.jsxs("div",{children:[e.jsx(r,{htmlFor:"location",children:"Location"}),e.jsx(c,{id:"location",value:i.location,onChange:s=>o({...i,location:s.target.value}),placeholder:"City, State, Country"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(r,{htmlFor:"phone",children:"Phone *"}),e.jsx(c,{id:"phone",value:i.phone,onChange:s=>o({...i,phone:s.target.value}),required:!0})]}),e.jsxs("div",{children:[e.jsx(r,{htmlFor:"whatsappNumber",children:"WhatsApp Number *"}),e.jsx(c,{id:"whatsappNumber",value:i.whatsappNumber,onChange:s=>o({...i,whatsappNumber:s.target.value}),placeholder:"+1234567890",required:!0})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(r,{htmlFor:"workingHoursStart",children:"Working Hours Start *"}),e.jsx(c,{id:"workingHoursStart",type:"time",value:i.workingHoursStart,onChange:s=>o({...i,workingHoursStart:s.target.value}),required:!0})]}),e.jsxs("div",{children:[e.jsx(r,{htmlFor:"workingHoursEnd",children:"Working Hours End *"}),e.jsx(c,{id:"workingHoursEnd",type:"time",value:i.workingHoursEnd,onChange:s=>o({...i,workingHoursEnd:s.target.value}),required:!0})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(r,{htmlFor:"carHandlingCapacity",children:"Car Handling Capacity *"}),e.jsxs(k,{value:i.carHandlingCapacity,onValueChange:s=>o({...i,carHandlingCapacity:s,maxConcurrentJobs:s==="SINGLE"?1:i.maxConcurrentJobs}),children:[e.jsx(S,{children:e.jsx(H,{})}),e.jsxs(P,{children:[e.jsx(u,{value:"SINGLE",children:"Single Car"}),e.jsx(u,{value:"MULTIPLE",children:"Multiple Cars"})]})]})]}),i.carHandlingCapacity==="MULTIPLE"&&e.jsxs("div",{children:[e.jsx(r,{htmlFor:"maxConcurrentJobs",children:"Max Concurrent Jobs *"}),e.jsx(c,{id:"maxConcurrentJobs",type:"number",min:"1",value:i.maxConcurrentJobs,onChange:s=>o({...i,maxConcurrentJobs:parseInt(s.target.value)||1}),required:!0})]})]}),e.jsx("div",{className:"flex justify-end pt-4 border-t border-border",children:e.jsx(w,{onClick:F,disabled:p,className:"min-h-[44px]",children:p?"Saving...":"Save Business Information"})})]})]})}),e.jsxs(E,{value:"settings",className:"space-y-4",children:[e.jsxs(g,{children:[e.jsxs(x,{children:[e.jsx(v,{children:"Operational Settings"}),e.jsx(b,{children:"Configure your business operations"})]}),e.jsxs(y,{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(r,{htmlFor:"settingsWorkingHoursStart",children:"Working Hours Start"}),e.jsx(c,{id:"settingsWorkingHoursStart",type:"time",value:a.workingHours?.start||"09:00",onChange:s=>l({...a,workingHours:{...a.workingHours,start:s.target.value}})})]}),e.jsxs("div",{children:[e.jsx(r,{htmlFor:"settingsWorkingHoursEnd",children:"Working Hours End"}),e.jsx(c,{id:"settingsWorkingHoursEnd",type:"time",value:a.workingHours?.end||"18:00",onChange:s=>l({...a,workingHours:{...a.workingHours,end:s.target.value}})})]})]}),e.jsxs("div",{children:[e.jsx(r,{htmlFor:"capacity",children:"Daily Capacity"}),e.jsx(c,{id:"capacity",type:"number",min:"1",value:a.capacity,onChange:s=>l({...a,capacity:parseInt(s.target.value)||5})}),e.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:"Maximum number of jobs per day"})]})]})]}),e.jsxs(g,{children:[e.jsxs(x,{children:[e.jsx(v,{children:"General Settings"}),e.jsx(b,{children:"Timezone preferences. Currency is set in Super Admin Settings and applies across the platform."})]}),e.jsx(y,{className:"space-y-4",children:e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:e.jsxs("div",{children:[e.jsx(r,{htmlFor:"timezone",children:"Timezone"}),e.jsxs(k,{value:a.timezone,onValueChange:s=>l({...a,timezone:s}),children:[e.jsx(S,{children:e.jsx(H,{})}),e.jsxs(P,{children:[e.jsx(u,{value:"UTC",children:"UTC"}),e.jsx(u,{value:"America/New_York",children:"EST (America/New_York)"}),e.jsx(u,{value:"America/Chicago",children:"CST (America/Chicago)"}),e.jsx(u,{value:"America/Denver",children:"MST (America/Denver)"}),e.jsx(u,{value:"America/Los_Angeles",children:"PST (America/Los_Angeles)"}),e.jsx(u,{value:"Asia/Kolkata",children:"IST (Asia/Kolkata)"})]})]})]})})})]}),e.jsxs(g,{children:[e.jsxs(x,{children:[e.jsx(v,{children:"Notification Preferences"}),e.jsx(b,{children:"Control when you receive notifications"})]}),e.jsxs(y,{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx(r,{children:"Auto-send WhatsApp Messages"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Automatically send WhatsApp notifications for job updates"})]}),e.jsx("input",{type:"checkbox",checked:a.autoSendWhatsApp,onChange:s=>l({...a,autoSendWhatsApp:s.target.checked}),className:"h-4 w-4"})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(r,{children:"Job Created"}),e.jsx("input",{type:"checkbox",checked:a.notificationPreferences?.jobCreated||!1,onChange:s=>l({...a,notificationPreferences:{...a.notificationPreferences,jobCreated:s.target.checked}}),className:"h-4 w-4"})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(r,{children:"Job Completed"}),e.jsx("input",{type:"checkbox",checked:a.notificationPreferences?.jobCompleted||!1,onChange:s=>l({...a,notificationPreferences:{...a.notificationPreferences,jobCompleted:s.target.checked}}),className:"h-4 w-4"})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(r,{children:"Job Delivered"}),e.jsx("input",{type:"checkbox",checked:a.notificationPreferences?.jobDelivered||!1,onChange:s=>l({...a,notificationPreferences:{...a.notificationPreferences,jobDelivered:s.target.checked}}),className:"h-4 w-4"})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(r,{children:"Plan Expiry Reminders"}),e.jsx("input",{type:"checkbox",checked:a.notificationPreferences?.planExpiry||!1,onChange:s=>l({...a,notificationPreferences:{...a.notificationPreferences,planExpiry:s.target.checked}}),className:"h-4 w-4"})]})]})]})]}),e.jsx("div",{className:"flex justify-end",children:e.jsx(w,{onClick:W,disabled:p,size:"lg",className:"min-h-[44px]",children:p?"Saving...":"Save Settings"})})]})]})]})}export{O as default};
