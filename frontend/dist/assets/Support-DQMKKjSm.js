import{a as r,u as a,j as e}from"./index-YmJ5rGxO.js";import{r as t}from"./vendor-redux-FsoCpCcR.js";import{C as L,a as D,b as P,c as z,d as E}from"./card-C1Os2Jzs.js";import{B as i}from"./button-BZ__ZVvs.js";import{I as m}from"./input-lKSy0GOu.js";import{L as c}from"./label-C0QsUGTD.js";import{D as O,e as M,a as R,b as H,c as F}from"./dialog-DioR_SNv.js";import{B as N}from"./badge-dOlDYKGI.js";import{T as je,a as ge,b as _,c as A}from"./tabs-ikx3-Flg.js";import{T as B}from"./textarea-CojeXS5Z.js";import{S as fe,a as ve,b as Ne,c as ye,d as y}from"./select-CkWAxkRE.js";import{B as be,G as Ce,M as we}from"./message-square-BkapI-Xp.js";import{S as I}from"./search-yXlgkkGt.js";import{P as U}from"./plus-BOAFu-8E.js";import{P as q}from"./pen-square-DESXZr50.js";import{T as Q}from"./trash-2-CyIO3SZl.js";import"./vendor-react-BGYP6dvN.js";import"./utils-Ckn0VQvi.js";import"./vendor-recharts-Bkxxru1U.js";import"./createLucideIcon-BRnZLpr8.js";function qe(){const[j,W]=t.useState("help"),[Y,J]=t.useState([]),[K,X]=t.useState([]),[Z,ee]=t.useState([]),[Se,G]=t.useState(!0),[o,b]=t.useState(""),[se,g]=t.useState(!1),[C,w]=t.useState(null),[n,u]=t.useState({title:"",content:"",category:"",isPublished:!0}),[te,f]=t.useState(!1),[S,T]=t.useState(null),[d,h]=t.useState({title:"",description:"",youtubeLink:"",steps:[],isPublished:!0}),[ae,v]=t.useState(!1),[p,le]=t.useState(null),[k,V]=t.useState("");t.useEffect(()=>{x()},[j]);const x=async()=>{G(!0);try{if(j==="help"){const s=await r.get("/super-admin/support/help-articles");J(s.data.articles||[])}else if(j==="tutorials"){const s=await r.get("/super-admin/support/tutorials");X(s.data.tutorials||[])}else if(j==="tickets"){const s=await r.get("/super-admin/support/tickets");ee(s.data.tickets||[])}}catch{a.error("Failed to fetch data")}finally{G(!1)}},ie=async()=>{try{C?(await r.put(`/super-admin/support/help-articles/${C._id}`,n),a.success("Help article updated")):(await r.post("/super-admin/support/help-articles",n),a.success("Help article created")),g(!1),w(null),u({title:"",content:"",category:"",isPublished:!0}),x()}catch{a.error("Failed to save help article")}},re=async s=>{if(confirm("Delete this help article?"))try{await r.delete(`/super-admin/support/help-articles/${s}`),a.success("Help article deleted"),x()}catch{a.error("Failed to delete")}},ce=async()=>{try{S?(await r.put(`/super-admin/support/tutorials/${S._id}`,d),a.success("Tutorial updated")):(await r.post("/super-admin/support/tutorials",d),a.success("Tutorial created")),f(!1),T(null),h({title:"",description:"",youtubeLink:"",steps:[],isPublished:!0}),x()}catch{a.error("Failed to save tutorial")}},ne=async s=>{if(confirm("Delete this tutorial?"))try{await r.delete(`/super-admin/support/tutorials/${s}`),a.success("Tutorial deleted"),x()}catch{a.error("Failed to delete")}},de=async()=>{if(k.trim())try{await r.post(`/super-admin/support/tickets/${p._id}/reply`,{message:k}),a.success("Reply sent"),V(""),v(!1),x()}catch{a.error("Failed to send reply")}},oe=async(s,l)=>{try{await r.patch(`/super-admin/support/tickets/${s}/status`,{status:l}),a.success("Ticket status updated"),x()}catch{a.error("Failed to update status")}},ue=s=>{const l={OPEN:"default",IN_PROGRESS:"secondary",RESOLVED:"success",CLOSED:"outline"};return e.jsx(N,{variant:l[s]||"default",children:s})},he=s=>{const l={LOW:"bg-gray-500",MEDIUM:"bg-blue-500",HIGH:"bg-orange-500",URGENT:"bg-red-500"};return e.jsx(N,{className:l[s]||"bg-gray-500",children:s})},pe=Y.filter(s=>s.title.toLowerCase().includes(o.toLowerCase())||s.content.toLowerCase().includes(o.toLowerCase())),xe=K.filter(s=>s.title.toLowerCase().includes(o.toLowerCase())||s.description.toLowerCase().includes(o.toLowerCase())),me=Z.filter(s=>s.subject.toLowerCase().includes(o.toLowerCase())||s.description.toLowerCase().includes(o.toLowerCase()));return e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"flex items-center justify-between",children:e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold tracking-tight",children:"Support Center"}),e.jsx("p",{className:"text-muted-foreground",children:"Manage help articles, tutorials, and support tickets"})]})}),e.jsxs(je,{value:j,onValueChange:W,children:[e.jsxs(ge,{children:[e.jsxs(_,{value:"help",children:[e.jsx(be,{className:"h-4 w-4 mr-2"}),"Help Articles"]}),e.jsxs(_,{value:"tutorials",children:[e.jsx(Ce,{className:"h-4 w-4 mr-2"}),"Tutorials"]}),e.jsxs(_,{value:"tickets",children:[e.jsx(we,{className:"h-4 w-4 mr-2"}),"Support Tickets"]})]}),e.jsxs(A,{value:"help",className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("div",{className:"relative flex-1",children:[e.jsx(I,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400"}),e.jsx(m,{placeholder:"Search help articles...",value:o,onChange:s=>b(s.target.value),className:"pl-10"})]}),e.jsxs(O,{open:se,onOpenChange:g,children:[e.jsx(M,{asChild:!0,children:e.jsxs(i,{onClick:()=>{w(null),u({title:"",content:"",category:"",isPublished:!0})},children:[e.jsx(U,{className:"h-4 w-4 mr-2"}),"New Article"]})}),e.jsxs(R,{className:"max-w-2xl",children:[e.jsx(H,{children:e.jsxs(F,{children:[C?"Edit":"Create"," Help Article"]})}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(c,{children:"Title"}),e.jsx(m,{value:n.title,onChange:s=>u({...n,title:s.target.value})})]}),e.jsxs("div",{children:[e.jsx(c,{children:"Category"}),e.jsx(m,{value:n.category,onChange:s=>u({...n,category:s.target.value}),placeholder:"e.g., Getting Started, Billing, etc."})]}),e.jsxs("div",{children:[e.jsx(c,{children:"Content"}),e.jsx(B,{value:n.content,onChange:s=>u({...n,content:s.target.value}),rows:10})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"checkbox",id:"helpPublished",checked:n.isPublished,onChange:s=>u({...n,isPublished:s.target.checked})}),e.jsx(c,{htmlFor:"helpPublished",children:"Published"})]}),e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsx(i,{variant:"outline",onClick:()=>g(!1),children:"Cancel"}),e.jsx(i,{onClick:ie,children:"Save"})]})]})]})]})]}),e.jsx("div",{className:"grid gap-4 md:grid-cols-2 lg:grid-cols-3",children:pe.map(s=>e.jsxs(L,{children:[e.jsxs(D,{children:[e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsx(P,{className:"text-lg",children:s.title}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(i,{variant:"ghost",size:"sm",onClick:()=>{w(s),u(s),g(!0)},children:e.jsx(q,{className:"h-4 w-4"})}),e.jsx(i,{variant:"ghost",size:"sm",onClick:()=>re(s._id),children:e.jsx(Q,{className:"h-4 w-4"})})]})]}),e.jsx(z,{children:s.category})]}),e.jsxs(E,{children:[e.jsx("p",{className:"text-sm text-muted-foreground line-clamp-3",children:s.content}),e.jsx(N,{variant:s.isPublished?"default":"secondary",className:"mt-2",children:s.isPublished?"Published":"Draft"})]})]},s._id))})]}),e.jsxs(A,{value:"tutorials",className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("div",{className:"relative flex-1",children:[e.jsx(I,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400"}),e.jsx(m,{placeholder:"Search tutorials...",value:o,onChange:s=>b(s.target.value),className:"pl-10"})]}),e.jsxs(O,{open:te,onOpenChange:f,children:[e.jsx(M,{asChild:!0,children:e.jsxs(i,{onClick:()=>{T(null),h({title:"",description:"",youtubeLink:"",steps:[],isPublished:!0})},children:[e.jsx(U,{className:"h-4 w-4 mr-2"}),"New Tutorial"]})}),e.jsxs(R,{className:"max-w-2xl",children:[e.jsx(H,{children:e.jsxs(F,{children:[S?"Edit":"Create"," Tutorial"]})}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(c,{children:"Title"}),e.jsx(m,{value:d.title,onChange:s=>h({...d,title:s.target.value})})]}),e.jsxs("div",{children:[e.jsx(c,{children:"Description"}),e.jsx(B,{value:d.description,onChange:s=>h({...d,description:s.target.value}),rows:3})]}),e.jsxs("div",{children:[e.jsx(c,{children:"YouTube Link"}),e.jsx(m,{value:d.youtubeLink,onChange:s=>h({...d,youtubeLink:s.target.value}),placeholder:"https://www.youtube.com/watch?v=..."})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"checkbox",id:"tutorialPublished",checked:d.isPublished,onChange:s=>h({...d,isPublished:s.target.checked})}),e.jsx(c,{htmlFor:"tutorialPublished",children:"Published"})]}),e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsx(i,{variant:"outline",onClick:()=>f(!1),children:"Cancel"}),e.jsx(i,{onClick:ce,children:"Save"})]})]})]})]})]}),e.jsx("div",{className:"grid gap-4 md:grid-cols-2 lg:grid-cols-3",children:xe.map(s=>e.jsxs(L,{children:[e.jsx(D,{children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsx(P,{className:"text-lg",children:s.title}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(i,{variant:"ghost",size:"sm",onClick:()=>{T(s),h(s),f(!0)},children:e.jsx(q,{className:"h-4 w-4"})}),e.jsx(i,{variant:"ghost",size:"sm",onClick:()=>ne(s._id),children:e.jsx(Q,{className:"h-4 w-4"})})]})]})}),e.jsxs(E,{children:[e.jsx("p",{className:"text-sm text-muted-foreground line-clamp-3",children:s.description}),s.youtubeLink&&e.jsx("div",{className:"mt-2",children:e.jsx("a",{href:s.youtubeLink,target:"_blank",rel:"noopener noreferrer",className:"text-sm text-blue-600 hover:underline",children:"Watch Video →"})}),e.jsx(N,{variant:s.isPublished?"default":"secondary",className:"mt-2",children:s.isPublished?"Published":"Draft"})]})]},s._id))})]}),e.jsxs(A,{value:"tickets",className:"space-y-4",children:[e.jsxs("div",{className:"relative flex-1",children:[e.jsx(I,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400"}),e.jsx(m,{placeholder:"Search tickets...",value:o,onChange:s=>b(s.target.value),className:"pl-10"})]}),e.jsx("div",{className:"space-y-4",children:me.map(s=>e.jsxs(L,{children:[e.jsx(D,{children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(P,{className:"text-lg",children:s.subject}),ue(s.status),he(s.priority)]}),e.jsxs(z,{children:["From: ",s.businessId?.businessName||"Unknown Business"," • ",new Date(s.createdAt).toLocaleDateString()]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(fe,{value:s.status,onValueChange:l=>oe(s._id,l),children:[e.jsx(ve,{className:"w-32",children:e.jsx(Ne,{})}),e.jsxs(ye,{children:[e.jsx(y,{value:"OPEN",children:"OPEN"}),e.jsx(y,{value:"IN_PROGRESS",children:"IN_PROGRESS"}),e.jsx(y,{value:"RESOLVED",children:"RESOLVED"}),e.jsx(y,{value:"CLOSED",children:"CLOSED"})]})]}),e.jsx(i,{variant:"outline",size:"sm",onClick:()=>{le(s),v(!0)},children:"View & Reply"})]})]})}),e.jsxs(E,{children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:s.description}),s.replies&&s.replies.length>0&&e.jsxs("div",{className:"mt-4 space-y-2",children:[e.jsxs("p",{className:"text-sm font-medium",children:["Replies (",s.replies.length,")"]}),s.replies.map((l,$)=>e.jsxs("div",{className:"bg-muted/80 p-3 rounded-lg",children:[e.jsx("p",{className:"text-sm",children:l.message}),e.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:new Date(l.repliedAt).toLocaleString()})]},$))]})]})]},s._id))}),e.jsx(O,{open:ae,onOpenChange:v,children:e.jsxs(R,{className:"max-w-2xl",children:[e.jsx(H,{children:e.jsx(F,{children:p?.subject})}),p&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(c,{children:"Description"}),e.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:p.description})]}),p.replies&&p.replies.length>0&&e.jsxs("div",{children:[e.jsx(c,{children:"Replies"}),e.jsx("div",{className:"space-y-2 mt-2",children:p.replies.map((s,l)=>e.jsxs("div",{className:"bg-muted/80 p-3 rounded-lg",children:[e.jsx("p",{className:"text-sm",children:s.message}),e.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:new Date(s.repliedAt).toLocaleString()})]},l))})]}),e.jsxs("div",{children:[e.jsx(c,{children:"Your Reply"}),e.jsx(B,{value:k,onChange:s=>V(s.target.value),rows:4,placeholder:"Type your reply here..."})]}),e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsx(i,{variant:"outline",onClick:()=>v(!1),children:"Cancel"}),e.jsx(i,{onClick:de,children:"Send Reply"})]})]})]})})]})]})]})}export{qe as default};
