import{a as l,u as r,j as e}from"./index-YmJ5rGxO.js";import{r as d}from"./vendor-redux-FsoCpCcR.js";import{C as o,a as f,b as R,c as D,d as k}from"./card-C1Os2Jzs.js";import{B as c}from"./button-BZ__ZVvs.js";import{B as N}from"./badge-dOlDYKGI.js";import{D as E,a as A,b,c as I}from"./dialog-DioR_SNv.js";import{c as q}from"./createLucideIcon-BRnZLpr8.js";import{C as y}from"./check-circle-DBNZYrM2.js";import{f as p}from"./format-CzBVktxt.js";import"./vendor-react-BGYP6dvN.js";import"./utils-Ckn0VQvi.js";import"./vendor-recharts-Bkxxru1U.js";/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const S=q("Eye",[["path",{d:"M2 12s3-7 10-7 10 7 10 7-3 7-10 7-10-7-10-7Z",key:"rwhkz3"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const v=q("XCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]]);function X(){const[m,C]=d.useState([]),[w,P]=d.useState(!0),[a,n]=d.useState(null);d.useEffect(()=>{i()},[]);const i=async()=>{try{const s=await l.get("/super-admin/upgrade-requests");s.data.success&&C(s.data.requests||[])}catch(s){r.error(s.response?.data?.message||"Failed to load requests")}finally{P(!1)}},u=async s=>{try{const t=await l.patch(`/super-admin/upgrade-requests/${s}/approve`);t.data.success?(r.success("Upgrade approved. Shop subscription updated."),n(null),i()):r.error(t.data.message||"Failed to approve")}catch(t){r.error(t.response?.data?.message||"Failed to approve")}},h=async s=>{try{const t=await l.patch(`/super-admin/upgrade-requests/${s}/reject`);t.data.success?(r.success("Upgrade rejected"),n(null),i()):r.error(t.data.message||"Failed to reject")}catch(t){r.error(t.response?.data?.message||"Failed to reject")}},x=s=>s.shopId?.businessName||s.shopId?.ownerName||"Shop",j=s=>s.currentPlanId?.name||"—",g=s=>s.requestedPlanId?.name||"—";return w?e.jsx("div",{className:"space-y-4",children:[1,2,3].map(s=>e.jsx(o,{className:"animate-pulse",children:e.jsx(f,{className:"h-20 bg-muted rounded-lg"})},s))}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold tracking-tight",children:"Upgrade Requests"}),e.jsx("p",{className:"text-muted-foreground",children:"Review and approve or reject plan upgrade requests from shops. No payment processing."})]}),e.jsx("div",{className:"space-y-4",children:m.map(s=>e.jsx(o,{children:e.jsx(f,{children:e.jsxs("div",{className:"flex flex-wrap items-start justify-between gap-4",children:[e.jsxs("div",{children:[e.jsx(R,{className:"text-lg",children:x(s)}),e.jsxs(D,{children:[j(s)," → ",g(s)]}),e.jsxs("p",{className:"text-sm text-muted-foreground mt-1",children:["Requested ",s.createdAt?p(new Date(s.createdAt),"PPp"):"—"]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(N,{variant:s.status==="PENDING"||s.status==="APPROVED"?"default":"secondary",className:s.status==="APPROVED"?"bg-green-600":s.status==="REJECTED"?"bg-gray-500":"",children:s.status}),e.jsx(c,{variant:"ghost",size:"icon",onClick:()=>n(s),"aria-label":"View details",children:e.jsx(S,{className:"h-4 w-4"})}),s.status==="PENDING"&&e.jsxs(e.Fragment,{children:[e.jsxs(c,{size:"sm",onClick:()=>u(s._id),className:"gap-1",children:[e.jsx(y,{className:"h-4 w-4"})," Approve"]}),e.jsxs(c,{size:"sm",variant:"destructive",onClick:()=>h(s._id),className:"gap-1",children:[e.jsx(v,{className:"h-4 w-4"})," Reject"]})]})]})]})})},s._id))}),m.length===0&&e.jsx(o,{children:e.jsx(k,{className:"p-12 text-center text-muted-foreground",children:"No upgrade requests yet. Shops will appear here when they request a plan upgrade."})}),e.jsx(E,{open:!!a,onOpenChange:s=>!s&&n(null),children:e.jsxs(A,{children:[e.jsx(b,{children:e.jsx(I,{children:"Upgrade request details"})}),a&&e.jsxs("div",{className:"space-y-3 text-sm",children:[e.jsxs("p",{children:[e.jsx("span",{className:"font-medium",children:"Shop:"})," ",x(a)]}),e.jsxs("p",{children:[e.jsx("span",{className:"font-medium",children:"Current plan:"})," ",j(a)]}),e.jsxs("p",{children:[e.jsx("span",{className:"font-medium",children:"Requested plan:"})," ",g(a)]}),e.jsxs("p",{children:[e.jsx("span",{className:"font-medium",children:"Request date:"})," ",a.createdAt?p(new Date(a.createdAt),"PPp"):"—"]}),a.actionedAt&&e.jsxs("p",{children:[e.jsx("span",{className:"font-medium",children:"Actioned:"})," ",p(new Date(a.actionedAt),"PPp")]}),a.message&&e.jsxs("p",{children:[e.jsx("span",{className:"font-medium",children:"Message:"})," ",a.message]}),e.jsxs("p",{children:[e.jsx("span",{className:"font-medium",children:"Status:"})," ",e.jsx(N,{children:a.status})]}),a.status==="PENDING"&&e.jsxs("div",{className:"flex gap-2 pt-2",children:[e.jsxs(c,{onClick:()=>u(a._id),className:"gap-1",children:[e.jsx(y,{className:"h-4 w-4"})," Approve"]}),e.jsxs(c,{variant:"destructive",onClick:()=>h(a._id),className:"gap-1",children:[e.jsx(v,{className:"h-4 w-4"})," Reject"]})]})]})]})})]})}export{X as default};
