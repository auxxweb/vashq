import{a as i,u as t,j as e}from"./index-YmJ5rGxO.js";import{r}from"./vendor-redux-FsoCpCcR.js";import{C as p,a as d,b as h,c as u,d as g}from"./card-C1Os2Jzs.js";import{B as n}from"./button-BZ__ZVvs.js";import{I as k}from"./input-lKSy0GOu.js";import{L as v}from"./label-C0QsUGTD.js";import{T as U}from"./textarea-CojeXS5Z.js";import{p as A}from"./formUtils-CjVQbo5F.js";import{L as l}from"./loader-2-Z6OQyPns.js";import{M as I}from"./message-circle-DvhV2ynm.js";import"./vendor-react-BGYP6dvN.js";import"./utils-Ckn0VQvi.js";import"./vendor-recharts-Bkxxru1U.js";import"./createLucideIcon-BRnZLpr8.js";const o={received:"Hello {{name}}, your vehicle {{vehicleNumber}} has been received. Token: {{token}}",inProgress:"Your car {{vehicleNumber}} is now in progress.",washing:"Your car {{vehicleNumber}} is currently being washed.",drying:"Your car {{vehicleNumber}} is being dried.",completed:"âœ… Your car wash for {{vehicleNumber}} is completed.",delivered:"ðŸš— Thank you! Your vehicle {{vehicleNumber}} has been delivered."},W={received:"Received",inProgress:"In Progress",washing:"Washing",drying:"Drying",completed:"Completed",delivered:"Delivered"},C="{{name}}, {{vehicleNumber}}, {{token}}";function se(){const[E,D]=r.useState(!0),[x,f]=r.useState(!1),[j,b]=r.useState(!1),[w,N]=r.useState(!1),[y,S]=r.useState(""),[L,T]=r.useState(""),[R,c]=r.useState({...o});r.useEffect(()=>{F()},[]);const F=async()=>{try{const s=await i.get("/admin/settings");if(s.data.success&&s.data.settings){const a=s.data.settings;S(a.shopWhatsappNumber||""),T(a.googleReviewLink||""),c({...o,...a.whatsappTemplates||{}})}}catch(s){t.error(s.response?.data?.message||"Failed to load settings")}finally{D(!1)}},P=async s=>{s?.preventDefault();const a=(y||"").trim();if(!a){t.error("Shop WhatsApp number is required");return}f(!0);try{await i.put("/admin/settings",{shopWhatsappNumber:a}),t.success("Shop WhatsApp number saved")}catch(m){t.error(m.response?.data?.message||"Failed to save")}finally{f(!1)}},Y=async s=>{s?.preventDefault(),b(!0);try{await i.put("/admin/settings",{whatsappTemplates:R}),t.success("Templates saved")}catch(a){t.error(a.response?.data?.message||"Failed to save templates")}finally{b(!1)}},G=()=>{c({...o}),t.success("Templates reset to default. Click Save Templates to apply.")},M=async s=>{s?.preventDefault(),N(!0);try{await i.put("/admin/settings",{googleReviewLink:(L||"").trim()}),t.success("Google Review link saved")}catch(a){t.error(a.response?.data?.message||"Failed to save link")}finally{N(!1)}};return E?e.jsx("div",{className:"flex items-center justify-center min-h-[40vh]",children:e.jsx(l,{className:"h-8 w-8 animate-spin text-muted-foreground"})}):e.jsxs("div",{className:"space-y-8",children:[e.jsxs("div",{children:[e.jsxs("h1",{className:"text-3xl font-bold tracking-tight flex items-center gap-2",children:[e.jsx(I,{className:"h-8 w-8 text-[#25D366]"}),"WhatsApp Settings"]}),e.jsx("p",{className:"text-muted-foreground mt-1",children:"Configure click-to-WhatsApp alerts for job status. No API or automation â€” you send messages manually from your number."})]}),e.jsxs(p,{children:[e.jsxs(d,{children:[e.jsx(h,{children:"Shop WhatsApp Number"}),e.jsx(u,{children:"Your shop WhatsApp number (with country code, e.g. 1234567890). Used for wa.me click-to-chat to the customer."})]}),e.jsx(g,{className:"space-y-4",children:e.jsxs("form",{onSubmit:P,onKeyDown:A,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(v,{htmlFor:"shopWhatsappNumber",children:"WhatsApp Number *"}),e.jsx(k,{id:"shopWhatsappNumber",type:"tel",placeholder:"e.g. 1234567890",value:y,onChange:s=>S(s.target.value),className:"mt-1"})]}),e.jsxs(n,{type:"submit",disabled:x,children:[x?e.jsx(l,{className:"h-4 w-4 animate-spin mr-2"}):null,"Save"]})]})})]}),e.jsxs(p,{children:[e.jsxs(d,{children:[e.jsx(h,{children:"WhatsApp Message Templates"}),e.jsxs(u,{children:["Editable messages for each job status. Use placeholders: ",C,". You can copy the pre-filled message and send from WhatsApp."]})]}),e.jsxs(g,{className:"space-y-4",children:[e.jsxs("p",{className:"text-sm text-muted-foreground",children:["Allowed placeholders: ",e.jsx("code",{className:"bg-muted px-1 rounded",children:C})]}),Object.keys(W).map(s=>e.jsxs("div",{children:[e.jsx(v,{htmlFor:`template-${s}`,children:W[s]}),e.jsx(U,{id:`template-${s}`,value:R[s]??"",onChange:a=>c(m=>({...m,[s]:a.target.value})),rows:3,className:"mt-1 font-mono text-sm",placeholder:o[s]})]},s)),e.jsxs("div",{className:"flex flex-wrap gap-2",children:[e.jsxs(n,{onClick:Y,disabled:j,children:[j?e.jsx(l,{className:"h-4 w-4 animate-spin mr-2"}):null,"Save Templates"]}),e.jsx(n,{type:"button",variant:"outline",onClick:G,children:"Reset to Default"})]})]})]}),e.jsxs(p,{children:[e.jsxs(d,{children:[e.jsx(h,{children:"Google Review Link"}),e.jsx(u,{children:'URL for customers to leave a Google review. Shown in the "Ask for Google Review" WhatsApp message after delivery.'})]}),e.jsx(g,{className:"space-y-4",children:e.jsxs("form",{onSubmit:M,onKeyDown:A,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(v,{htmlFor:"googleReviewLink",children:"Google Review URL"}),e.jsx(k,{id:"googleReviewLink",type:"url",placeholder:"https://g.page/your-business/review",value:L,onChange:s=>T(s.target.value),className:"mt-1"})]}),e.jsxs(n,{type:"submit",disabled:w,children:[w?e.jsx(l,{className:"h-4 w-4 animate-spin mr-2"}):null,"Save Link"]})]})})]})]})}export{se as default};
